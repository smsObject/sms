<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hbh.sms.dal.dao.MeterDataMapper">
    <resultMap id="BaseResultMap" type="com.hbh.sms.model.entity.MeterData">
        <result column="id" property="id"/>
        <result column="meterId" property="meterId"/>
        <result column="code" property="code"/>
        <result column="value" property="value"/>
        <result column="upLoadTime" property="uploadTime"/>
        <result column="unit" property="unit"/>
        <result column="createTime" property="createTime"/>
    </resultMap>

    <sql id="Base_Column_List">
        id, meterId, code, value, upLoadTime, unit, createTime
    </sql>

    <insert id="insert" parameterType="com.hbh.sms.model.entity.MeterData">
        <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into t_meterdata (meterId, code, value,
        upLoadTime, unit, createTime
        )
        values (#{meterid}, #{code}, #{value},
        now(), #{unit}, now()
        )
    </insert>

    <!--<insert id="insertSelective" parameterType="com.hbh.sms.model.entity.MeterData" >-->
    <!--<selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER" >-->
    <!--SELECT LAST_INSERT_ID()-->
    <!--</selectKey>-->
    <!--insert into t_meterdata-->
    <!--<trim prefix="(" suffix=")" suffixOverrides="," >-->
    <!--<if test="meterid != null" >-->
    <!--meterId,-->
    <!--</if>-->
    <!--<if test="code != null" >-->
    <!--code,-->
    <!--</if>-->
    <!--<if test="value != null" >-->
    <!--value,-->
    <!--</if>-->
    <!--<if test="uploadtime != null" >-->
    <!--upLoadTime,-->
    <!--</if>-->
    <!--<if test="unit != null" >-->
    <!--unit,-->
    <!--</if>-->
    <!--<if test="createtime != null" >-->
    <!--createTime,-->
    <!--</if>-->
    <!--</trim>-->
    <!--<trim prefix="values (" suffix=")" suffixOverrides="," >-->
    <!--<if test="meterid != null" >-->
    <!--#{meterid},-->
    <!--</if>-->
    <!--<if test="code != null" >-->
    <!--#{code},-->
    <!--</if>-->
    <!--<if test="value != null" >-->
    <!--#{value},-->
    <!--</if>-->
    <!--<if test="uploadtime != null" >-->
    <!--now(),-->
    <!--</if>-->
    <!--<if test="unit != null" >-->
    <!--#{unit},-->
    <!--</if>-->
    <!--<if test="createtime != null" >-->
    <!--now(),-->
    <!--</if>-->
    <!--</trim>-->
    <!--</insert>-->

    <sql id="queyWhere">
        <where>
            <if test="meterId !=null and meterId !=0">
                AND meterId = #{meterId}
            </if>
            <if test="code !=null and code !=''">
                AND code = #{code}
            </if>
        </where>
    </sql>

    <select id="query" resultMap="BaseResultMap" parameterType="com.hbh.sms.model.entity.MeterData">
        SELECT
        <include refid="Base_Column_List" />
          FROM t_meterdata
        <include refid="queyWhere"/>
    </select>

</mapper>